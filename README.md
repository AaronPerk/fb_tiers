This code is written only to run on Mac OSX.